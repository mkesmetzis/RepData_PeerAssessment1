---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
library(knitr)
library(dplyr)
setwd("~/R/R Projects/5.Reproducible Research/Peer Assessment 1")
alldata <- read.csv("activity.csv",header = T)

### Process/transform the data (if necessary) into a format suitable for your analysis
data <- alldata[with (alldata, {
    !(is.na(steps))
}),]

## What is mean total number of steps taken per day?
### 1. Calculate the total number of steps taken per day
steps_by_day <- summarise(group_by(data, date), total = sum(steps))

### 2. Make a histogram of the total number of steps taken each day
hist(steps_by_day$total, main = "Total Steps made by day",xlab = "Total Steps by day")

### 3. Calculate and report the mean and median of the total number of steps taken per day
summary(steps_by_day)

## What is the average daily activity pattern?
#### 1.Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
steps_by_interval <- aggregate(steps ~ interval, data , mean)
plot(
    steps_by_interval$interval, steps_by_interval$steps, type = 'l',
    xlab = "Interval",
    ylab = "Average number of steps",main = "Time series of steps over all days"
)

#### 2. #Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
max_steps_row <- which.max(steps_by_interval$steps)
steps_by_interval[max_steps_row,]

## Imputing missing values


## Are there differences in activity patterns between weekdays and weekends?
